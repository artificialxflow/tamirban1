# چک‌لیست جامع اجرای پروژه «تعمیربان» (شروع از صفر)

این سند برای شروع پروژه جدید در محیط Next.js + TypeScript + Tailwind تدوین شده است و باید در مخزن تازه‌ ایجادشده قرار گیرد. همه آیتم‌ها در حالت انجام‌نشده هستند تا بتوان روند را مرحله‌به‌مرحله دنبال کرد.

## فاز 0 — هماهنگی و پیش‌نیازها
- [ ] تایید محدوده و خروجی‌ها بر اساس `explaination.md`
- [ ] مشخص کردن نقش‌ها، زمان‌بندی و نحوه گزارش‌دهی
- [ ] انتخاب سرویس پیامکی و دریافت دسترسی‌ها (در صورت آماده نبودن، ثبت در لیست تعلیق)
- [ ] دریافت قالب فایل Excel برای Import مشتری‌ها از کارفرما
- [ ] هماهنگی با هاست سی‌پنل برای اجرای برنامه Node.js روی پورت 3124 و دسترسی به SSH/FTP

## فاز 1 — راه‌اندازی پروژه Next.js (Tailwind + TypeScript)
- [ ] ساخت مخزن جدید و اجرای `npx create-next-app@latest tamirban --ts --tailwind`
- [ ] پاک‌سازی نمونه‌ها و تعریف ساختار پوشه‌ها (`app/`, `lib/`, `modules/`, `postman/`, `public/`, `docs/`)
- [ ] افزودن فونت «ایران یکان» در `public/fonts` و تعریف آن در `tailwind.config.ts`
- [ ] تنظیم زبان فارسی و RTL در `app/layout.tsx` و `app/globals.css`
- [ ] پیکربندی Theme پایه (رنگ‌ها، سایه‌ها، spacing) با Tailwind
- [ ] راه‌اندازی ESLint/Prettier و فعال‌سازی TypeScript strict mode
- [ ] ایجاد `postman/README.md` برای آماده‌سازی کالکشن‌ها و مستندات API

## فاز 2 — تنظیمات محیطی و استقرار سی‌پنل
- [ ] ایجاد `.env.example` با متغیرهای پایه (PORT=3124، NEXT_PUBLIC_SITE_URL، MONGODB_URI، SMS Provider)
- [ ] پیاده‌سازی `server.js` برای اجرای Next.js روی پورت 3124 با `next start`
- [ ] افزودن اسکریپت `start:server` به `package.json`
- [ ] تست اجرای محلی با `node server.js`
- [ ] نوشتن راهنمای استقرار در `docs/deployment-cpanel.md`

## فاز 3 — طراحی UI پایه با تایید مرحله‌ای
- [ ] طراحی Layout اصلی (Header، Sidebar، Main) و نمایش به کارفرما برای تایید
- [ ] تنظیم تایپوگرافی و مقیاس فونت‌ها (فونت ایران یکان) و تایید
- [ ] پیاده‌سازی UI صفحه ورود/OTP (بدون بک‌اند) و دریافت تایید
- [ ] پیاده‌سازی UI صفحه داشبورد (بدون داده واقعی) و دریافت تایید
- [ ] طراحی UI صفحات Customers، Marketers، Visits، Invoices، Settings (UI-only) و تایید تک‌به‌تک
- [ ] ساخت کتابخانه کامپوننت‌ها (Buttons، Inputs، Cards، Tables، Tabs، Modals)
- [ ] تست ریسپانسیو و RTL در هر مرحله پیش از اتصال به داده

## فاز 4 — مدل داده و اتصال MongoDB
- [ ] تعریف Types/Interfaces برای User، Contact، Visit، Product، Invoice، SMSLog
- [ ] راه‌اندازی اتصال به MongoDB با URI پروژه و تست سلامت اتصال
- [ ] ایجاد لایه Repository/Service برای عملیات CRUD و فیلترها
- [ ] نوشتن تست‌های واحد برای سرویس‌ها (Jest یا Vitest)
- [ ] مستندسازی ساختار داده در `docs/data-model.md`

## فاز 5 — احراز هویت و مدیریت نقش‌ها
- [ ] پیاده‌سازی احراز هویت با شماره موبایل و OTP (حالت تست: کد ثابت بدون SMS واقعی)
- [ ] ادغام سرویس پیامکی برای ارسال OTP واقعی (پس از آماده شدن سرویس)
- [ ] هش کردن OTPها و رمزهای یک‌بارمصرف با `bcrypt`
- [ ] صدور و مدیریت توکن‌های دسترسی/تازه‌سازی با `JWT`
- [ ] مستندسازی گزینه جایگزین (NextAuth Credentials) و دلیل انتخاب رویکرد JWT
- [ ] صفحه مدیریت کاربران: ایجاد دستی بازاریاب، فعال/غیرفعال، تعیین نقش و دسترسی اختصاصی
- [ ] پیاده‌سازی Role-Based Access Control در سطح API و UI
- [ ] ثبت لاگ ورود/خروج و رویدادهای امنیتی

## فاز 6 — ماژول‌های اصلی پنل وب
- [ ] **Customers:** CRUD کامل، جستجو و فیلتر، Import از Excel، مدیریت آدرس/لوکیشن، تاریخچه تعاملات
- [ ] **Marketers:** مدیریت حساب بازاریاب‌ها، تعیین سطح دسترسی، وضعیت فعال/غیرفعال
- [ ] **Catalog:** مدیریت محصولات، قیمت، دسته‌بندی و تصاویر
- [ ] **Visits:** نمایش روی نقشه نشان، ثبت ویزیت، یادداشت، پیگیری و نیازسنجی
- [ ] **Invoices:** ایجاد/ویرایش، محاسبه، وضعیت‌ها، تولید PDF داخلی و دانلود
- [ ] **SMS Center:** ارسال پیامک فعال‌سازی و تبلیغاتی، لیست ارسال‌ها و وضعیت
- [ ] **Dashboard:** نمایش KPI، نمودارها، کارت‌های وضعیت و فیلتر زمانی
- [ ] ارائه دموی هر ماژول به کارفرما پس از اتصال داده برای تایید نهایی UI/UX

## فاز 7 — API RESTful و Postman
- [ ] طراحی ساختار Endpointها، متدها و پاسخ‌ها برای همه ماژول‌ها
- [ ] پیاده‌سازی Route Handlerهای Next.js با Middlewareهای احراز هویت، Validation، Rate Limit
- [ ] ساخت Postman Collection با مثال درخواست/پاسخ
- [ ] ایجاد Postman Environment (پایه URL، توکن، شماره تست OTP)
- [ ] افزودن تست‌های Postman (pre-request و test scripts)
- [ ] اشتراک‌گذاری مستندات و کالکشن با تیم Flutter/Android

## فاز 8 — آماده‌سازی انتقال به Flutter/Android
- [ ] جمع‌آوری دارایی‌های UI نهایی (تصاویر استاتیک صفحات، Style Guide، Tokenهای Tailwind)
- [ ] تولید راهنمای `docs/flutter-handoff.md` شامل معماری، قراردادهای API، نقش‌ها و سناریوها
- [ ] استخراج نمونه درخواست/پاسخ Postman و الحاق به راهنما
- [ ] تدوین چک‌لیست فازبندی شده توسعه Flutter (Bootstrap → Auth → ماژول‌ها → تست → انتشار)
- [ ] مستندسازی نیازهای امنیتی موبایل (ذخیره JWT/Refresh، مدیریت انقضا، Re-auth)
- [ ] تهیه پرامپت‌ها یا توضیحات استاتیک برای انتقال به تیم طراحی/توسعه موبایل

## فاز 9 — اپلیکیشن Flutter/Android (پس از تحویل راهنمای انتقال)
- [ ] ایجاد پروژه Flutter جدید و تنظیمات اولیه
- [ ] اتصال به REST API (حالت تست OTP) و پیاده‌سازی مدیریت JWT/Refresh Token
- [ ] پیاده‌سازی صفحات Auth، Dashboard، Customers، Visits، Invoices مطابق راهنمای وب
- [ ] ادغام Push Notification و مدیریت Device Token
- [ ] تست عملکرد و UI روی دستگاه‌های اندرویدی هدف
- [ ] همگام‌سازی راهنمای انتقال در صورت اعمال تغییر در تجربه کاربری

## فاز 10 — تضمین کیفیت و امنیت
- [ ] پوشش تست‌های واحد و Integration برای وب و API
- [ ] اجرای تست‌های End-to-End (Playwright یا Cypress)
- [ ] تست دستی در موبایل، تبلت و دسکتاپ (RTL + PWA)
- [ ] بررسی امنیتی (Rate Limit، Validation، Sanitization، مدیریت session)
- [ ] آزمون کارایی (پاسخ API، ایجاد PDF، Import/Export Excel)
- [ ] تهیه ویدئوی آموزشی و راهنمای کاربری
- [ ] ممیزی پایگاه داده و ارتباطات (بررسی روابط، ایندکس‌ها، محدودیت‌ها و کفایت داده)
- [ ] بازبینی سناریوهای CRM انتها به انتها (ایجاد کاربر → ویزیت → پیش‌فاکتور → گزارش)

## فاز 11 — استقرار و تحویل
- [ ] ساخت Build نهایی (`next build`)
- [ ] استقرار روی سی‌پنل با `node server.js` و پورت 3124
- [ ] اتصال دامنه `https://tamirban1.ir/` به برنامه Node.js (تنظیمات ریورس پراکسی یا Application Manager)
- [ ] تنظیم و تست SSL روی دامنه
- [ ] قرار دادن `.env` نهایی روی سرور (عدم انتشار در مخزن)
- [ ] تست نهایی روی محیط واقعی برای همه سناریوهای کلیدی
- [ ] تحویل Postman Collection و Environment به تیم اندروید
- [ ] توافق بر برنامه پشتیبانی و به‌روزرسانی‌های آینده

## پیگیری و مستندسازی
- [ ] به‌روزرسانی منظم `todo.md` و `explaination.md` با پیشرفت واقعی
- [ ] ثبت تصمیمات معماری در `docs/architecture.md`
- [ ] نگهداری CHANGELOG برای نسخه‌های مهم
- [ ] دیدار/جلسه دوره‌ای با کارفرما جهت تایید UI و عملکرد
- [ ] آماده‌سازی چک‌لیست تحویل نهایی برای اطمینان از پوشش همه موارد


